
typedef unsigned char  u8;
typedef unsigned short u16;

extern void  LongJmpTestReturn(void);


u8 baInvokeCounts[20];
u8 bGlbWayMark;

_noreturn void SysUtilTrap(u16 nReason, int dummy) {
//    PORTA &= ~(1<<3);                               // stop more attacks while we exit with data.
    baInvokeCounts[10]++;
    LongJmpTestReturn();
    for(;;);
}


void SysSecurityWatchDogNext(u8 bWaymark) {
        baInvokeCounts[11]++;
        bGlbWayMark++;
        if(bGlbWayMark != bWaymark) {
            SysUtilTrap(42, 43);
        }
}
